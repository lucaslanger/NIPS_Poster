%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Jacobs Landscape Poster
% LaTeX Template
% Version 1.1 (14/06/14)
%
% Created by:
% Computational Physics and Biophysics Group, Jacobs University
% https://teamwork.jacobs-university.de:8443/confluence/display/CoPandBiG/LaTeX+Poster
%
% Further modified by:
% Nathaniel Johnston (nathaniel@njohnston.ca)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[final]{beamer}

\usepackage[scale=1.24]{beamerposter} % Use the beamerposter package for laying out the poster
\usepackage{subcaption}
\usepackage{blkarray}

\usetheme{confposter} % Use the confposter theme supplied with this template

\newcommand{\psrsigma}{\langle \Sigma, \aone, \ainf, \{\A_\sigma\}_{\sigma \in \Sigma} \rangle}
\newcommand{\mpsrsigma}{\langle \Sigma, \Sigma', \kappa, \aone, \ainf, \{\A_\sigma\}_{\sigma \in \Sigma'} \rangle}

\setbeamercolor{block title}{fg=black,bg=white} % Colors of the block titles
\setbeamercolor{block body}{fg=black,bg=white} % Colors of the body of blocks
\setbeamercolor{block alerted title}{fg=white,bg=ddblue!70} % Colors of the highlighted block titles
\setbeamercolor{block alerted body}{fg=black,bg=dblue!10} % Colors of the body of highlighted blocks
% Many more colors are available for use in beamerthemeconfposter.sty

%-----------------------------------------------------------
% Define the column widths and overall poster size
% To set effective sepwid, onecolwid and twocolwid values, first choose how many columns you want and how much separation you want between columns
% In this template, the separation width chosen is 0.024 of the paper width and a 4-column layout
% onecolwid should therefore be (1-(# of columns+1)*sepwid)/# of columns e.g. (1-(4+1)*0.024)/4 = 0.22
% Set twocolwid to be (2*onecolwid)+sepwid = 0.464
% Set threecolwid to be (3*onecolwid)+2*sepwid = 0.708

\newlength{\sepwid}
\newlength{\onecolwid}
\newlength{\twocolwid}
\newlength{\threecolwid}
\setlength{\paperwidth}{48in} % A0 width: 46.8in
\setlength{\paperheight}{36in} % A0 height: 33.1in
\setlength{\sepwid}{0.024\paperwidth} % Separation width (white space) between columns
\setlength{\onecolwid}{0.22\paperwidth} % Width of one column
\setlength{\twocolwid}{0.464\paperwidth} % Width of two columns
\setlength{\threecolwid}{0.708\paperwidth} % Width of three columns
\setlength{\topmargin}{-0.5in} % Reduce the top margin size
%-----------------------------------------------------------

\usepackage{graphicx}  % Required for including images

\usepackage{booktabs} % Top and bottom rules for tables

\input{cmds}
\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\title{Learning Multi-Step Predictive
     State Representations} % Poster title

\author{Lucas Langer, Borja Balle, Doina Precup} % Author(s)

\institute{Reasoning and Learning Lab, McGill University} % Institution(s)

%----------------------------------------------------------------------------------------

\begin{document}

\addtobeamertemplate{block end}{}{\vspace*{2ex}} % White space under blocks
\addtobeamertemplate{block alerted end}{}{\vspace*{2ex}} % White space under highlighted (alert) blocks

\setlength{\belowcaptionskip}{2ex} % White space under figures
\setlength\belowdisplayshortskip{2ex} % White space under equations

\begin{frame}[t] % The whole poster is enclosed in one beamer frame

\begin{columns}[t] % The whole poster consists of three major columns, the second of which is split into two columns twice - the [t] option aligns each column's content to the top

\begin{column}{\sepwid}\end{column} % Empty spacer column

\begin{column}{\onecolwid} % The first column

%----------------------------------------------------------------------------------------
%	OBJECTIVES
%----------------------------------------------------------------------------------------

\begin{block}{Abstract}
With spectral learning algorithms, we consider the problem of making predictions in partially observable environments. Spectral algorithms learn a linear representation of a system's internal states and can be used to make predictions of future observations conditioned on the past (Boots et al., 2011). Such predictions have been applied to robotics, where expectations of the future guide planning decisions (Bacon et al., 2015). 
%They can also be used in medical time-series, such as when one has evolving information from a patient (blood sugar, temperature, etc.) and wants to assess the health of the patient. 
Spectral algorithms have the advantage that they are statistically consistent with well known error bounds (Citation). In this work, we develop a novel extension to a previous spectral based representation. We augment Predictive State Representations (PSRs) with multi-step transition operators to get Multi-Step Predictive State Representations (M-PSRs). In experiments, the novel representation far outperforms its predecessor when using regularized models.

\end{block} 
 
%\begin{block}{Highlights}
%We considered the problem of making predictions in %partially observable environments with spectral learning %algorithms:

%\begin{itemize}
%\item Based on previous work with predictive state %representations (PSR), we developed a novel extension %called the M-PSR
%\item We developed algorithms for learning the new %parameters  of M-PSRs
%\item We applied M-PSRs to robot navigation in labyrinth %environments and found large performance improvements
%\end{itemize}
%\end{block}

%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------

%\begin{block}{Motivation}

%Spectral algorithms have theoretical guarantees which make them highly desirable to use over other methods. Traditional applications of such models include:

%\begin{itemize}
%  \item Planning decisions in robotics or game AIs
%  \item Natural language processing
%  \item Time series: medical data, speech processing, %financial modelling)
%\end{itemize}

%\end{block}

\begin{block}{Overview}

\begin{figure}
\includegraphics[height=33cm,width=1.00\linewidth]{M-PSR_Flow_Chart.pdf}
\end{figure}

\end{block}





%----------------------------------------------------------------------------------------

\end{column} % End of the first column
\begin{column}{\sepwid}\end{column} % Empty spacer column
\begin{column}{\twocolwid} % Begin a column which is two columns wide (column 2)
\begin{columns}[t,totalwidth=\twocolwid] % Split up the two columns wide column

\begin{column}{\twocolwid}\vspace{-.6in} % The first column within column 2 (column 2.1)

\begin{block}{Multi-Step Predictive State Representations (M-PSRs)}

As with traditional PSRs, M-PSRs compute a probability function  on observation strings $f_A: \Sigma^{*} \mapsto [0,1]$. 
A traditional PSR is defined by the tuple: $\psrsigma$, where $\Sigma$ is the set of observations, $\alpha_{\lambda}$ is an initial weighting on states, $\alpha_{\infty}$ is a normalizing vector, and $\{\A_\sigma\}_{\sigma \in \Sigma}$ is a set of transition operators.
%We define an M-PSR by the tuple: $\mpsrsigma$. 
%The goal of the
An M-PSR expresses transitions more compactly
%. This is accomplished 
by including operators which represent sequences of observations: $\Sigma' \subset \Sigma^*$
%.   With additional operators, it becomes necessary to specify
and a way of partitioning strings
%. For an M-PSR, we call this it's 
which we call an encoding function $\kappa$.

\end{block}

\begin{block}{Probability Queries}

%To illustrate the difference between PSRs and M-PSRs, we will show probability queries using both representations. 
With traditional PSRs, transition operators are applied for each observation $\sigma_i$ in $x=\sigma_1 \cdots \sigma_n$.

{\large
\begin{equation*}
f_{\psrA}(x) ~=~ f_{\psrA}(\sigma_1 \cdots \sigma_n) ~=~ \aone^\top \A_{\sigma_1} \cdots \A_{\sigma_n} \ainf \enspace
\end{equation*}
}
\vspace{-1.5cm}

For M-PSRs, we apply multi-step transition operators for each observation sequence $s_i$ in $\kappa(x)=s_1 \cdots s_m$

%Here, m is the length of the encoding and depends on x.

{\large
\begin{equation*}
f_{\psrA}(x) ~=~ f_{\psrA}(s_1 \cdots s_m) ~=~ \aone^\top \A_{s_1} \cdots \A_{s_m} \ainf \enspace
\end{equation*}
\vspace{-2cm}
}
\end{block}
\end{column} % End of column 2.2
\end{columns} % End of the split of column 2 - any content after this will now take up 2 columns width


%\begin{block}{Learning M-PSRs from Data}

%The probabilities over sequences in our embedded system can be summarized in a Hankel matrix,
%a bi-infinite (conceptually) matrix $\H_f \in \R^{\Sstar \times \Sstar}$ with rows and
%columns indexed by strings in $\Sstar$. We estimated the Hankel matrix for a fixed finite subsets of rows and columns. The SVD decomposition
%of $\H_f$ provides a way to recover a PSR (see Boots et al., 2011). This algorithm is easily extended for M-PSRs and remains statistically consistent.

%\end{block}

\begin{block}{Base M-PSRs}

As an example, a natural approach to build an M-PSR for timing $\Sigma=\{\sigma\}$, is to use powers of a fixed base $b$:

{\large
\begin{equation*}
\Sigma' ~=~ \{\sigma,~\sigma^b,~ \sigma^{b^2},\ldots, \sigma^{b^K}\}
\end{equation*}
}
\vspace{-1.5cm}

For given observation string: $\sigma^t$, we compute $t = t_0 b^0 + t_1 b^1 + t_2 b^2 + \cdots + t_K b^K$ and then the encoding follows:


{\large
\begin{equation*}
\kappa(\sigma^t) ~=~ (\sigma^{b^K})^{t_K}~ (\sigma^{b^{K-1}})^{t_{K-1}} \cdots (\sigma^b)^{t_1}~ (\sigma)^{t_0}
\end{equation*}}

%, where $0 \leq t_k \leq b - 1$ for $0 \leq k \leq K$, and $t_K \geq 0$
\vspace{-2cm}
\end{block}

\begin{block}{Data-Driven M-PSRs}

%Experiments indicate that compact representations of transitions yield better predictions.

For a general M-PSR we propose that $\kappa(x)$ be the encoding of minimal length. $\kappa(x)$ is computed by dynamic programming, giving the additional benefit that one can perform optimal state updates for online applications.
 
{
\large \begin{equation*}
\kappa(x) ~= \argmin_{ z \in \Sigma', \; x=yz, \; |y|<|x|} |\kappa(y)(z)| \enspace 
\end{equation*}}

With this choice of $\kappa$, we build $\Sigma'$ by iteratively selecting sub-strings from the training set:

{
\large \begin{equation*}
\Sigma'_{i+1} ~=~ \argmin_{u \in \mathrm{sub}_M} ~\sum_{x \in \mathrm{train}} |\kappa_{\Sigma_i' \cup \{u\}}(x)| \enspace
\end{equation*}}

% Is y supposed to be in \Sigma* here???
%Above, $\partial$ is the decoding function for $\kappa$

\end{block}

\vspace{3ex}

%----------------------------------------------------------------------------------------
\end{column}

\begin{column}{\sepwid}\end{column} % Empty spacer column
\begin{column}{\onecolwid} % The third column

%----------------------------------------------------------------------------------------
%	CONCLUSION
%----------------------------------------------------------------------------------------

\begin{block}{Experiments}

We simulated robot trajectories in labyrinth environments. Observations are time and wall colors. 

  \vspace{-2cm}
  \begin{figure}
      \begin{subfigure}{1.1\textwidth}
        \includegraphics[width=\textwidth]{figs/Pacman/Pacman10k.png}
      \end{subfigure}
      ~
      \begin{subfigure}{1.1\textwidth}
        \includegraphics[width=\textwidth]{figs/DLMO/MO_1k.png}
      \end{subfigure}
      ~
      %\begin{subfigure}[b]{0.48\textwidth}
      %  \includegraphics[width=\textwidth]%{figs/DL/doubleLoopImage.png}
        %\caption{}
      %\end{subfigure}
      %~
      %\begin{subfigure}[b]{0.48\textwidth}
      %  \includegraphics[width=\textwidth]{pac-man.jpg}
      %  \caption{}
      %\end{subfigure}
       %~
      %\begin{subfigure}[b]{0.33\textwidth}
        %\includegraphics[height=11cm,width=9cm{figs/Pacman/graphPacMan.png}
        %\caption{}
      %\end{subfigure}
      
  \end{figure}
\end{block}
\vspace{-4.4ex}

\begin{block}{Conclusion}

M-PSRs offer large improvements over traditional PSRs when using smaller model sizes, as is often desired in practice. These improvements offer various prospects for future work:

\begin{itemize}
  \item Applications: planning, physiological signal recordings, and financial time-series
  \item Further optimization of the encoding function $\kappa$ and selection of transition sequences $\Sigma'$
  \item Theoretical analysis of M-PSRs
\end{itemize}

\end{block}

%\begin{block}{References}

%\citep{balle2013spectral} % Insert publications even if they are not cited in the poster
%\citep{boots2010closing}
%\citep{pierrelucplanning2015}
%\small{\bibliographystyle{unsrt}
%\bibliography{sample}\vspace{0.75in}}
%\bibliographystyle{abbrv}
%\bibliography{sigproc}

%\end{block}

%----------------------------------------------------------------------------------------
%	REFERENCES
%----------------------------------------------------------------------------------------

%\begin{block}{References}

%\nocite{*} % Insert publications even if they are not cited in the poster
%\small{\bibliographystyle{unsrt}
%\bibliography{sample}\vspace{0.75in}}

%\end{block}

%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

%\setbeamercolor{block title}{fg=red,bg=white} % Change the block title color

%\begin{block}{Acknowledgements}

%\small{\rmfamily{Nam mollis tristique neque eu luctus. Suspendisse rutrum congue nisi sed convallis. Aenean id neque dolor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.}} \\

%\end{block}

%----------------------------------------------------------------------------------------
%	CONTACT INFORMATION
%----------------------------------------------------------------------------------------

%\setbeamercolor{block alerted title}{fg=black,bg=norange} % Change the alert block title colors
%\setbeamercolor{block alerted body}{fg=black,bg=white} % Change the alert block body colors

%\begin{alertblock}{Contact Information}

%\begin{itemize}
%\item Web: \href{http://www.university.edu/smithlab}{http://www.university.edu/smithlab}
%\item Email: \href{mailto:john@smith.com}{john@smith.com}
%\item Phone: +1 (000) 111 1111
%\end{itemize}

%\end{alertblock}

%\begin{center}
%\includegraphics[width=0.6\linewidth]{mcgill.pdf} %& \hfill & \includegraphics[width=0.3\linewidth]{rllab.pdf}
%\end{center}

%----------------------------------------------------------------------------------------

\end{column} % End of the third column

\end{columns} % End of all the columns in the poster

\end{frame} % End of the enclosing frame

\end{document}
